<!DOCTYPE html 
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
  <title>openSIPS | Documentation / Script Format - ver 1.9 | History</title>
  <meta http-equiv='Content-Style-Type' content='text/css' />
  <link rel='stylesheet' href="opensips.css" tppabs="http://www.opensips.org/pub/skins/opensips/opensips.css" type='text/css' />
  <!--HTMLHeader--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  
span.anchor {
	float: left;
	font-size: 10px;
	margin-left: -10px;
	width: 10px;
    position:relative; top:-0.1em;
	text-align: center;
}
span.anchor a { text-decoration: none; }
span.anchor a:hover { text-decoration: underline; }
ol.toc { text-indent:-20px; list-style: none; }
ol.toc ol.toc { text-indent:-40px; }
div.tocfloat { font-size: smaller; margin-bottom: 10px;
    border-top: 1px dotted #555555; border-bottom: 1px dotted #555555;
    padding-top: 5px; padding-bottom: 5px; 
    width: 38%; float: right; margin-left: 10px; clear: right;
    margin-right:-13px; padding-right: 13px; padding-left: 13px;
    background-color: #eeeeee; }
div.toc { font-size: smaller; 
    padding: 4px; border: 1px dotted #cccccc;
    background: #f7f7f7;
    margin-bottom: 10px; }
  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
  .editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  .diffbox { width:570px; border-left:1px #999999 solid; margin-top:1.33em; }
  .diffauthor { font-weight:bold; }
  .diffchangesum { font-weight:bold; }
  .difftime { font-family:verdana,sans-serif; font-size:66%; 
    background-color:#dddddd; }
  .difftype { clear:both; font-family:verdana,sans-serif; 
    font-size:66%; font-weight:bold; }
  .diffadd { border-left:5px #99ff99 solid; padding-left:5px; }
  .diffdel { border-left:5px #ffff99 solid; padding-left:5px; }
  .diffrestore { clear:both; font-family:verdana,sans-serif; 
    font-size:66%; margin:1.5em 0px; }
  .diffmarkup { font-family:monospace; }  
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }

--></style><script type="text/javascript">
function toggle(obj) {
    var elstyle = document.getElementById(obj).style;
    var text    = document.getElementById(obj + "tog");
    if (elstyle.display == 'none') {
        elstyle.display = 'block';
        text.innerHTML = "hide";
    } else {
        elstyle.display = 'none';
        text.innerHTML = "show";
    }
}
</script>
  <link href="commentboxplus.css" tppabs="http://www.opensips.org/pub/commentboxplus/commentboxplus.css" rel='stylesheet' type='text/css' />
  <link rel='stylesheet' href="wsplus.css" tppabs="http://www.opensips.org/pub/wsplus/wsplus.css" 
    type='text/css' />
  <!--[if IE]><style type='text/css' media='screen'>
    body { behavior:url("csshover.htc")/*tpa=http://www.opensips.org/pub/wsplus/csshover.htc*/; }
    .rollover * { visibility: visible; }
  </style><![endif]-->
  <meta name='robots' content='noindex,nofollow' />

  <link rel="icon" type="image/png" href="http://opensips.org/favicon.png">
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','analytics.js'/*tpa=http://www.google-analytics.com/analytics.js*/,'ga');

  ga('create', 'UA-47615177-1', 'http://www.opensips.org/Documentation/opensips.org');
  ga('send', 'pageview');

	function resizeIframe(obj) {
	    obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';
		  }

  </script>

</head>
<body>
<div id="main">
<!--PageHeaderFmt-->
  <div id='wikilogo'>
  <img class="motto" src="motto.jpg" tppabs="http://www.opensips.org/pub/skins/opensips/images/motto.jpg" width="328" height="40" alt="The new breed of communication engine.">
  <a href="javascript:if(confirm(%27http://www.opensips.org/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.opensips.org/%27" tppabs="http://www.opensips.org/"><img class="logo" src="logo2.jpg" tppabs="http://www.opensips.org/pub/skins/opensips/images/logo2.jpg"
    alt='openSIPS' border='0' /></a>
 </div>
 <div id='wikihead'>
 <table border=0>
  <tr valign=top><td width=250>
   
  </td></tr>
  <tr><td width=250>
   <form action="http://www.opensips.org/">
   
    <input type='hidden' name='n' value='Documentation.Script-Format-1-9' />
    <input type='hidden' name='action' value='search' />

    <input type='text' name='q' id='formsubmit' value='' class='inputbox searchbox' />
	<input type='submit' id='formbutton' class='inputbutton searchbutton' value=' ' /></form>
  </td></tr>
  </table>
 </div>

<!--/PageHeaderFmt-->
<div id="osTopNav" >
	<div id="osTopNavLeft">
	</div>

	<div id="osTopNavRight">
	</div>

	<ul id="osTopNavList">
		<li>
			<a href="javascript:if(confirm(%27http://www.opensips.org/About/About  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.opensips.org/About/About%27" tppabs="http://www.opensips.org/About/About" title="About">About</a>
		</li>
		<li>
			<a href="javascript:if(confirm(%27http://www.opensips.org/Downloads/Downloads  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.opensips.org/Downloads/Downloads%27" tppabs="http://www.opensips.org/Downloads/Downloads" title="Download">Downloads</a>
		</li>
		<li>
			<a href="Manuals.htm" tppabs="http://www.opensips.org/Documentation/Manuals" title="Documentation">Documentation</a>
		</li>
		<li>
			<a href="javascript:if(confirm(%27http://www.opensips.org/Community/Foundation-Main  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.opensips.org/Community/Foundation-Main%27" tppabs="http://www.opensips.org/Community/Foundation-Main" title="Community">Community</a>
		</li>
		<li>
			<a href="javascript:if(confirm(%27http://www.opensips.org/Development/Development  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.opensips.org/Development/Development%27" tppabs="http://www.opensips.org/Development/Development" title="Development">Development</a>
		</li>
		<li>
			<a href="javascript:if(confirm(%27http://www.opensips.org/Support/Contact  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.opensips.org/Support/Contact%27" tppabs="http://www.opensips.org/Support/Contact" title="Support">Support</a>
		</li>
	</ul>
</div>
<!--PageMenuFmt-->
<!--/PageMenuFmt-->
  <table width='100%' align="center" cellpadding='0' cellspacing='0' id='wikimid'>
    <tr>
<!--PageLeftFmt-->
      <td valign='top' bgcolor="#E2F8DA" id='wikileft'>
        <p class='sidehead'> <span  style='color: #185662;'> Documentation</span>
</p><ul><li><a class='wikilink' title='Manuals' href="Manuals.htm" tppabs="http://www.opensips.org/Documentation/Manuals">Manuals</a>
</li><li><a class='wikilink' title='Tutorials' href="Tutorials.htm" tppabs="http://www.opensips.org/Documentation/Tutorials">Advanced Tutorials</a>
</li><li><a class='wikilink' title='TipsFAQ' href="TipsFAQ.htm" tppabs="http://www.opensips.org/Documentation/TipsFAQ">Tips &amp; FAQ</a>
</li><li><a class='wikilink' title='Migration' href="Migration.htm" tppabs="http://www.opensips.org/Documentation/Migration">Version Migration</a>
</li><li><a class='wikilink' title='Webinars' href="Webinars.htm" tppabs="http://www.opensips.org/Documentation/Webinars">OpenSIPS Webinars</a>
</li><li><a class='wikilink' title='Troubleshooting' href="Troubleshooting.htm" tppabs="http://www.opensips.org/Documentation/Troubleshooting">Troubleshooting</a>
</li><li><a class='wikilink' title='Tools' href="Tools.htm" tppabs="http://www.opensips.org/Documentation/Tools">OpenSIPS Tools</a>
</li><li><a class='wikilink' title='Development-Tutorials' href="Development-Tutorials.htm" tppabs="http://www.opensips.org/Documentation/Development-Tutorials">Devel Tutorial</a>
</li></ul><div class='vspace'></div>
</td>
<!--/PageLeftFmt-->
      <td id='wikibody' valign='top'>
<!--PageTitleFmt-->
        
<!--PageText-->
<div id='wikitext'>
<h2 class='wikiaction'>Documentation.Script-Format-1-9 History</h2>
  <p><a href="Script-Format-1-9-action=diff&source=y&minor=y.htm" tppabs="http://www.opensips.org/Documentation/Script-Format-1-9?action=diff&source=y&minor=y">Show minor edits</a> - <a href="javascript:if(confirm(%27http://www.opensips.org/Documentation/Script-Format-1-9?action=diff&source=n&minor=n  \n\nThis file was not retrieved by Teleport Pro, because it was unavailable, or its retrieval was aborted, or the project was stopped too soon.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.opensips.org/Documentation/Script-Format-1-9?action=diff&source=n&minor=n%27" tppabs="http://www.opensips.org/Documentation/Script-Format-1-9?action=diff&source=n&minor=n">Show changes to output</a></p>
  <div id='wikidiff'>
      <div class='diffbox'><div class='difftime'>August 05, 2013, at 02:57 PM 
        by <span class='diffauthor' title='109.99.235.212'>109.99.235.212</span> - </div>
        <div class='difftype'>Changed line 4 from:</div>
        <div class='diffdel'><div class='diffmarkup'>[- Page for other versions: [[Script-Format|devel]] 1.9 [[Script-Format-1-8|1.8]] old versions: [[Script-Format-1-7|1.7]] [[Script-Format-1-6|1.6]] [[Script-Format-1-5|1.5]] [[Script-Format-1-4|1.4]] -]</div></div>
        <div class='difftype'>to:</div>
        <div class='diffadd'><div class='diffmarkup'>(:allVersions Script-Format 1.9:)</div></div></div>
      <div class='diffrestore'><a href="Script-Format-1-9-action=edit&restore=diff-1375707442-1369765395-&preview=y.htm" tppabs="http://www.opensips.org/Documentation/Script-Format-1-9?action=edit&restore=diff:1375707442:1369765395:&preview=y">Restore</a></div>
      <div class='diffbox'><div class='difftime'>May 28, 2013, at 08:23 PM 
        by <span class='diffauthor' title='109.99.235.212'>109.99.235.212</span> - </div>
        <div class='difftype'>Changed line 4 from:</div>
        <div class='diffdel'><div class='diffmarkup'>[- Page for other versions: [[Script-Format|devel]] 1.9 [[Script-Format-1-8|1.8]] old versions : [[Script-Format-1-7|1.7]] [[Script-Format-1-6|1.6]] [[Script-Format-1-5|1.5]] [[Script-Format-1-4|1.4]] -]</div></div>
        <div class='difftype'>to:</div>
        <div class='diffadd'><div class='diffmarkup'>[- Page for other versions: [[Script-Format|devel]] 1.9 [[Script-Format-1-8|1.8]] old versions: [[Script-Format-1-7|1.7]] [[Script-Format-1-6|1.6]] [[Script-Format-1-5|1.5]] [[Script-Format-1-4|1.4]] -]</div></div></div>
      <div class='diffrestore'><a href="Script-Format-1-9-action=edit&restore=diff-1369765395-1369764088-&preview=y.htm" tppabs="http://www.opensips.org/Documentation/Script-Format-1-9?action=edit&restore=diff:1369765395:1369764088:&preview=y">Restore</a></div>
      <div class='diffbox'><div class='difftime'>May 28, 2013, at 08:01 PM 
        by <span class='diffauthor' title='109.99.235.212'>109.99.235.212</span> - </div>
        <div class='difftype'>Added lines 1-93:</div>
        <div class='diffadd'><div class='diffmarkup'>!!!!!Documentation -&gt; [[Documentation.Manuals|Manuals]] -&gt; [[Documentation.Manual-1-9|Manual 1.9]] -&gt; Script Format<br />(:title Script Format - ver 1.9 :)<br />----<br />[- Page for other versions: [[Script-Format|devel]] 1.9 [[Script-Format-1-8|1.8]] old versions : [[Script-Format-1-7|1.7]] [[Script-Format-1-6|1.6]] [[Script-Format-1-5|1.5]] [[Script-Format-1-4|1.4]] -]<br /><br />\\<br /><br />|| %color=#185662%[+'''Script Format 1.9'''+]%% ||<br /><br />||[[Generating-Configs-1-9|Prev]] || [[Script-CoreParameters-1-9|Next]]||<br />----<br /><br />The OpenSIPs configuration script has three main logical parts :<br /><br /># global parameters <br /># modules section<br /># routing logic<br /><br />----<br />!!!! Global parameters<br /><br />Usually, in the first part, you declare the [[Documentation/Script-CoreParameters-1-9|OpenSIPS global parameters]] - these global or core parameters are affecting the OpenSIPS core and possible the modules.<br /><br />Configuring the network listeners, available transport protocols, forking (and number of processes), the logging and other global stuff is provided by these global parameters.<br /><br />Example:<br /><br />[@<br />disable_tcp = yes<br />listen = udp:192.168.2.10:5060<br />listen = udp:192.168.2.10:5070<br />fork = yes<br />children = 4<br />log_stderror = no<br />@]<br /><br />----<br />!!!! Modules section<br /><br />In regards to the OpenSIPS modules,the modules that are to be loaded (no module is loaded by default) are specified by using the directive '''loadmodule'''. Modules are to be specified by name and an optional path (to the ''.so'' file). If no path is provided (and just the name of the module), the default path will be assumed for locating the loading the module (default path is ''/usr/lib/opensips/modules'' if not other one configured at [[Documentation/Compile-And-Install-1-9|compile time]]. For configuring a different path, either the path is pushed directly with the module name (to get control per module) or it can be globally (for all modules) configured via the '''mpath''' global parameter.\\\<br />Once the modules are loaded, the parameters of the modules may be set using the '''modparam''' directive - to list of available parameters for each module, the type of parameter value (integer or string) can be found in the [[Documentation/Modules-1-9|documentation of the modules]], the ''Parameters'' section.<br /><br />Examples:<br />[@<br />loadmodule &quot;modules/mi_datagram/mi_datagram.so&quot;<br />modparam(&quot;mi_datagram&quot;, &quot;socket_name&quot;, &quot;udp:127.0.0.1:4343&quot;)<br />modparam(&quot;mi_datagram&quot;, &quot;children_count&quot;, 3)<br />@]<br /><br />or <br /><br />[@<br />mpath=&quot;/usr/local/opensips_proxy/lib/modules&quot;<br />loadmodule &quot;mi_datagram.so&quot;<br />modparam(&quot;mi_datagram&quot;, &quot;socket_name&quot;, &quot;udp:127.0.0.1:4343&quot;)<br />modparam(&quot;mi_datagram&quot;, &quot;children_count&quot;, 3)<br />loadmodule &quot;mi_fifo.so&quot;<br />modparam(&quot;mi_fifo&quot;, &quot;fifo_name&quot;, &quot;/tmp/opensips_fifo&quot;)<br />@]<br /><br />----<br />!!!! Routing logic<br /><br />The routing logic is actually a sum of routes (script routes) that contain the OpenSIPS logic for routing SIP traffic. The description of '''OpenSIPS behavior in relation to the SIP traffic''' is done via this routes.\\\<br />There are different types of routes : <br /># '''top routes''' - routes that are directly triggered by OpenSIPs when some events occurs (like SIP request received, SIP reply received, transaction failed, etc)<br /># '''sub-routes''' - routes that are triggered / used from other routes in script.<br />\\<br />What are the existing '''top routes''', when they are triggered, what kind of SIP messages is handled, what SIP operations are allowed and other are documented in the [[Documentation/Script-Routes-1-9| types of routes section]].\\\<br />The '''sub-routes''' have names and they are to be called from any other route (top or sub) in the script via their names. The '''sub-routes''' may take parameters (when called) or return a numerical code (avoid returning 0 value as this will terminate your whole script. The '''sub-routes''' are similar to functions / procedure in any programing language.<br />See the [[Documentation/Script-CoreFunctions-1-9#toc41| description of the ''route'' ]] directive.<br /><br /><br />Example:<br />[@<br />route { # top route triggered on incoming SIP requests<br />   if ( route(src_ip_is_gw) ) {<br />      xlog(&quot;request $rm comes from GW\n&quot;);<br />   }<br />}<br /><br />onreply_route { # top route triggered on incoming SIP replies<br />   if ( route(src_ip_is_gw) ) {<br />      xlog(&quot;reply $rc comes from GW\n&quot;);<br />   }<br />}<br /><br />route[src_ip_is_gw] { #sub-route<br />   if ($si=='11.22.33.44' || $si=='11.22.33.45')<br />      return 1;<br />   return -1;<br />}<br />@]</div></div></div>
      <div class='diffrestore'><a href="Script-Format-1-9-action=edit&restore=diff-1369764088-1369764088-&preview=y.htm" tppabs="http://www.opensips.org/Documentation/Script-Format-1-9?action=edit&restore=diff:1369764088:1369764088:&preview=y">Restore</a></div></div></div>
  
<!--PageRightFmt--><!--/PageRightFmt--></td>
</tr></table>
<!--PageFooterFmt-->
  <div id='wikifoot'>
  <hr class="bottomline" /></td>
    <div class='footnav'>
	
      <a rel="nofollow" href="Script-Format-1-9-action=edit.htm" tppabs="http://www.opensips.org/Documentation/Script-Format-1-9?action=edit">Edit</a> |
      <a rel="nofollow" href="Script-Format-1-9-action=diff.htm" tppabs="http://www.opensips.org/Documentation/Script-Format-1-9?action=diff">History</a> |
      <a rel="nofollow" href="Script-Format-1-9-action=print.htm" tppabs="http://www.opensips.org/Documentation/Script-Format-1-9?action=print" target='_blank'>Print</a> |
      <a href="RecentChanges.htm" tppabs="http://www.opensips.org/Documentation/RecentChanges">Recent Changes</a> |
      <a href="javascript:if(confirm(%27http://www.opensips.org/Site/Search  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.opensips.org/Site/Search%27" tppabs="http://www.opensips.org/Site/Search">Search</a></div>
    <div class='lastmod'>Page last modified on August 05, 2013, at 02:57 PM</div></div>
<!--HTMLFooter-->
</div>
</body>
</html>
